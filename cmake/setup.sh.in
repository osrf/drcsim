# This file is the entry point for drcsim users.  It should establish all environment necessary to use the drcsim.

# Step 1: get ROS configuration.  Special case for different shells, to pull in command-line completion.
if [ $SHELL = /bin/bash ]; then
  . /opt/ros/@ROS_DISTRO@/setup.bash
elif [ $SHELL = /bin/zsh ]; then
  . /opt/ros/@ROS_DISTRO@/setup.zsh
else
  . /opt/ros/@ROS_DISTRO@/setup.sh 
fi

# Step 2: modify ROS configuration.
# Add each of our installed model directories to ROS_PACKAGE_PATH, so that ROS tools can locate resources stored within them.  
# We don't just add the top 'models' directory because it contains a 'manifest.xml', which stops rospack in its tracks.
for d in `find @CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/environments -mindepth 1 -maxdepth 1 -type d | tr "\n" ":"`; do export ROS_PACKAGE_PATH=$d$ROS_PACKAGE_PATH; done
for d in `find @CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/atlas_description -mindepth 1 -maxdepth 1 -type d | tr "\n" ":"`; do export ROS_PACKAGE_PATH=$d$ROS_PACKAGE_PATH; done
for d in `find @CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/multisense_sl_description -mindepth 1 -maxdepth 1 -type d | tr "\n" ":"`; do export ROS_PACKAGE_PATH=$d$ROS_PACKAGE_PATH; done
for d in `find @CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/irobot_hand_description -mindepth 1 -maxdepth 1 -type d | tr "\n" ":"`; do export ROS_PACKAGE_PATH=$d$ROS_PACKAGE_PATH; done
# Also add our 'ros' directory to RPP; it contains utility packages with things like launch files
export ROS_PACKAGE_PATH=@SANDIA_HAND_ROS_PACKAGE_PATH@:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/ros:$ROS_PACKAGE_PATH
export ROS_PACKAGE_PATH=@OSRF_COMMON_ROS_PACKAGE_PATH@:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/ros:$ROS_PACKAGE_PATH
# Make ROS plugins visible to the runtime loader; they'll be pulled in by ROS via pluginlib
export LD_LIBRARY_PATH=@CMAKE_INSTALL_PREFIX@/lib/@PROJECT_NAME@-@DRC_SIM_VERSION@/AtlasSimInterface_@ATLAS_SIM_INTERFACE_VERSION_FULL@:@CMAKE_INSTALL_PREFIX@/@LIB_INSTALL_DIR@/@PROJECT_NAME@-@DRC_SIM_VERSION@/plugins:$LD_LIBRARY_PATH

# Step 3: get Gazebo configuration.
if [ -f @GAZEBO_PREFIX@/share/gazebo/setup.sh ]; then
  . @GAZEBO_PREFIX@/share/gazebo/setup.sh 
elif [ -f /usr/share/gazebo/setup.sh ]; then
  . /usr/share/gazebo/setup.sh  
else
  echo "Warning: failed to find Gazebo's setup.sh.  You will need to source it manually."
fi

# Step 4: modify Gazebo configuration.
export GAZEBO_RESOURCE_PATH=@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/worlds:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@:$GAZEBO_RESOURCE_PATH
export GAZEBO_MODEL_PATH=@SANDIA_HAND_ROS_PACKAGE_PATH@/sandia_hand_description/gazebo:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/irobot_hand_description:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/multisense_sl_description:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/atlas_description:@CMAKE_INSTALL_PREFIX@/share/@PROJECT_NAME@-@DRC_SIM_VERSION@/gazebo_models/environments:$GAZEBO_MODEL_PATH
export GAZEBO_PLUGIN_PATH=@CMAKE_INSTALL_PREFIX@/@LIB_INSTALL_DIR@/@PROJECT_NAME@-@DRC_SIM_VERSION@/plugins:$GAZEBO_PLUGIN_PATH
